# 六 CPU

## 1 概述

1. 程序计数器（PC）：指出下一条指令在主存中的位置，具有自增功能。

   （其位数取决于主存空间大小，比如4GB，就需要至少30位)

2. 指令寄存器（IR）：保存当前要执行的指令

3. 存储器地址寄存器（MAR）

4. 存储器数据寄存器（MDR）

以上这部分，绪论时已经介绍过。

### 时序系统

组合逻辑单元：

> 处理数据值的单元，都叫组合单元，比如ALU。

状态逻辑单元：

>带有内部存储功能，就是状态单元

### 通用寄存器组



## 二 指令周期

## 三 流水线

![image-20230629101150577](https://taufik.oss-cn-beijing.aliyuncs.com/img/image-20230629101150577.png)

将一条指令的执行过程，分为若干阶段，每个阶段都由相应的部件完成。

好处就是可以提高效率。如果每条指令都是从头到尾以此执行，当执行到EX时，IF 和ID都是空闲的状态，浪费了资源。而流水线则是通俗的话讲就是，把各个部件的空闲时间，都利用了起来

五个阶段分别如下

1. 首先是取指令（IF），这点很好理解，不取指令是没法开始操作的
2. 接着是译码阶段（ID）：**操作控制器**对指令进行译码
3. 执行（EX）：进行运算
4. 访存（MEM）：对存储器

### 流水线冒险

什么叫冒险？就是流水线堵塞了，就是这么简单！

一共有三种情况，分别是**结构冒险，数据冒险，控制冒险。**

#### 1 结构冒险

从字面上可会让人误解，本意其实是由于多个指令争用同一资源造成的冲突。

也叫资源冲突。

解决办法：

1. 冲突的指令，暂停一个时钟周期
2. 单独设置数据存储器和指令存储器

#### 2 数据冒险

最简单的情况就是，当下一条指令，需要上一条的数据时，在流水线中就会发生冲突。

#### 3 控制冒险？？

遇到改变指令时，改变PC值，导致断流。