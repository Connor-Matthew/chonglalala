# 一 基本概念

## 操作系统

是计算机硬件和软件资源的管理者。

![image-20230810151436823](https://taufik.oss-cn-beijing.aliyuncs.com/img/image-20230810151436823.png)

主要功能如下：

1. 对软件和硬件进行管理
2. 为上层用户提供方便的接口和环境
3. 最接近硬件的**软件**

### 1.1 资源管理者

1. 找到QQ的运行程序：**文件管理**
2. 启动QQ：**存储器管理（把程序放入内存）**
3. 运行QQ：**处理机管理**
4. 视频通话：**设备管理**

### 1.2 接口

程序接口：比如$prinf$函数，直接请求了操作系统的服务，这就是程序接口的作用，用户是无法使用的，只能通过程序进行调用。

### 1.3 虚拟机

覆盖了软件的机器，称之为虚拟机，让硬件发挥更强的作用和功能。



## 2 特征

### 2.1 并发

多个事件交替运行，比如第一秒执行A，第二秒执行B，第三秒执行C

如果把时间间隔缩短成毫秒，微秒，那么宏观上看貌似是一起执行的。

> 并行：则是对应于多核处理器，每次可以同时执行多个程序

### 2.2 共享

  互斥共享和“同时”共享

前者是，一段时间内，只能一个进程访问。

后者是，每个时间间隔内，轮流使用，达到了宏观的同时。

### 2.3 虚拟

#### 空分复用

内存虚拟：只有8GB内存，但是可以同时运行远超过8GB的程序，比如大型3A，QQ，微信，浏览器等。

#### 时分复用

CPU虚拟：单核处理器却能打开很多的软件，QQ，微信，浏览器等

### 2.4 异步

由于资源的有限性，进程的执行可能会走走停停，这就叫异步。

## 3 运行机制

### 3.1 内核程序与应用程序

内核程序就是操作系统内核，最接近核心部分。

应用程序是普通程序员写的程序。



### 3.2 特权指令和非特权指令 

特权指令：比如内存清零，就只有“内核”才可以使用

非特权指令：普通的应用程序可以使用的指令



如何区分呢？

CPU设计了两种状态：

1. 内核态：可以运行内核程序
2. 用户态：运行普通的应用程序

> 在CPU中有个寄存器，程序状态字寄存器（PSW），1代表内核态，0是用户态

例子

![image-20230810165106418](https://taufik.oss-cn-beijing.aliyuncs.com/img/image-20230810165106418.png)

## 4 中断和异常

### 中断的作用

用户态变为内核态，使得内核夺回CPU使用权限！

也就可以实现并发！

#### 内中断和外中断

内中断：若指令是非法的，比如黑客入侵，除零或者**陷入指令**

> 陷入指令：应用程序请求内核的服务，比如printf

外中断：

比如时间片到时间了，这时候时钟部件就会发送时钟信号，进行外中断。



## 5 系统调用

比如wps请求打印文档，中途word也提交申请，由于是并发执行，很可能出现混打的情况，这不是我们希望看到的。

**<u>*所以就要交给操作系统进行协调管理。*</u>**

## 6 虚拟机

#### 第一类

直接运行在硬件上

![image-20230811155042061](https://taufik.oss-cn-beijing.aliyuncs.com/img/image-20230811155042061.png)

#### 第二类

套娃在宿主操作系统上

![image-20230811155303948](https://taufik.oss-cn-beijing.aliyuncs.com/img/image-20230811155303948.png)

这里就是使用虚拟机软件，比如virtual box等。